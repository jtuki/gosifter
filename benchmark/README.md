# benchmark

针对 gosifter 性能上的压测。

主要的考量点在于，增加了筛查流程后，整体的 encode/marshal 性能。

## result

整体上来看，序列化性能下降的程度还是很明显的。原因主要是两方面：

1. gosifter 增加的额外操作；
2. json 序列化 map 类型（而非特定的结构体类型）使得其 encoder 缓存机制失效；

直接进行 json 序列化的结果：

```
[2017-02-06 14:24:31.100+0800]  start: prepare_benchmark_data_set
[2017-02-06 14:24:31.198+0800] finish: prepare_benchmark_data_set; duration[0.098420(s)]
[2017-02-06 14:24:36.208+0800][ 5.01] total_tasks[             1806428] total_bytes[           543734828]
[2017-02-06 14:24:41.207+0800][10.01] total_tasks[             3611041] total_bytes[          1086923341]
[2017-02-06 14:24:46.220+0800][15.02] total_tasks[             5413835] total_bytes[          1629564335]
[2017-02-06 14:24:51.206+0800][20.01] total_tasks[             7194956] total_bytes[          2165681756]
[2017-02-06 14:24:56.198+0800][25.00] total_tasks[             8609296] total_bytes[          2591398096]
[2017-02-06 14:25:01.207+0800][30.01] total_tasks[            10282310] total_bytes[          3094975310]
[2017-02-06 14:25:06.209+0800][35.01] total_tasks[            11963705] total_bytes[          3601075205]
[2017-02-06 14:25:11.208+0800][40.01] total_tasks[            13721838] total_bytes[          4130273238]
[2017-02-06 14:25:16.206+0800][45.01] total_tasks[            14895587] total_bytes[          4483571687]
[2017-02-06 14:25:21.198+0800][50.00] total_tasks[            15839687] total_bytes[          4767745787]
[2017-02-06 14:25:26.202+0800][55.00] total_tasks[            17466007] total_bytes[          5257268107]
final result:
[2017-02-06 14:25:31.208+0800][60.01] total_tasks[            19267869] total_bytes[          5799628569]
```

使用 gosifter 进行序列化的结果：

```
[2017-02-06 14:25:59.444+0800]  start: prepare_benchmark_data_set
[2017-02-06 14:25:59.568+0800] finish: prepare_benchmark_data_set; duration[0.124512(s)]
[2017-02-06 14:26:04.584+0800][ 5.02] total_tasks[              418867] total_bytes[           126078967]
[2017-02-06 14:26:09.594+0800][10.03] total_tasks[              838345] total_bytes[           252341845]
[2017-02-06 14:26:14.580+0800][15.01] total_tasks[             1252096] total_bytes[           376880896]
[2017-02-06 14:26:19.577+0800][20.01] total_tasks[             1666131] total_bytes[           501505431]
[2017-02-06 14:26:24.569+0800][25.00] total_tasks[             2084753] total_bytes[           627510653]
[2017-02-06 14:26:29.572+0800][30.00] total_tasks[             2503070] total_bytes[           753424070]
[2017-02-06 14:26:34.572+0800][35.00] total_tasks[             2921054] total_bytes[           879237254]
[2017-02-06 14:26:39.583+0800][40.01] total_tasks[             3337725] total_bytes[          1004655225]
[2017-02-06 14:26:44.584+0800][45.02] total_tasks[             3752335] total_bytes[          1129452835]
[2017-02-06 14:26:49.578+0800][50.01] total_tasks[             4167230] total_bytes[          1254336230]
[2017-02-06 14:26:54.579+0800][55.01] total_tasks[             4577466] total_bytes[          1377817266]
[2017-02-06 14:26:59.570+0800][60.00] total_tasks[             4993696] total_bytes[          1503102496]
final result:
[2017-02-06 14:26:59.571+0800][60.00] total_tasks[             4993702] total_bytes[          1503104302]
```
